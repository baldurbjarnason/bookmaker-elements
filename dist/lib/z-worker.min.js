(function t(e){"use strict";if(e.zWorkerInitialized)throw new Error("z-worker.js should be run only once");e.zWorkerInitialized=true;addEventListener("message",function(t){var e=t.data,c=e.type,n=e.sn;var s=r[c];if(s){try{s(e)}catch(t){a(c,n,t)}}});var r={importScripts:n,newTask:s,append:p,flush:p};var c={};function n(t){if(t.scripts&&t.scripts.length>0)importScripts.apply(undefined,t.scripts);postMessage({type:"importScripts"})}function s(t){var r=e[t.codecClass];var n=t.sn;if(c[n])throw Error("duplicated sn");c[n]={codec:new r(t.options),crcInput:t.crcType==="input",crcOutput:t.crcType==="output",crc:new u};postMessage({type:"newTask",sn:n})}var o=e.performance?e.performance.now.bind(e.performance):Date.now;function p(t){var e=t.sn,r=t.type,n=t.data;var p=c[e];if(!p&&t.codecClass){s(t);p=c[e]}var a=r==="append";var i=o();var u;if(a){try{u=p.codec.append(n,function t(r){postMessage({type:"progress",sn:e,loaded:r})})}catch(t){delete c[e];throw t}}else{delete c[e];u=p.codec.flush()}var f=o()-i;i=o();if(n&&p.crcInput)p.crc.append(n);if(u&&p.crcOutput)p.crc.append(u);var d=o()-i;var v={type:r,sn:e,codecTime:f,crcTime:d};var l=[];if(u){v.data=u;l.push(u.buffer)}if(!a&&(p.crcInput||p.crcOutput))v.crc=p.crc.get();try{postMessage(v,l)}catch(t){postMessage(v)}}function a(t,e,r){var c={type:t,sn:e,error:i(r)};postMessage(c)}function i(t){return{message:t.message,stack:t.stack}}function u(){this.crc=-1}u.prototype.append=function t(e){var r=this.crc|0,c=this.table;for(var n=0,s=e.length|0;n<s;n++)r=r>>>8^c[(r^e[n])&255];this.crc=r};u.prototype.get=function t(){return~this.crc};u.prototype.table=function(){var t,e,r,c=[];for(t=0;t<256;t++){r=t;for(e=0;e<8;e++)if(r&1)r=r>>>1^3988292384;else r=r>>>1;c[t]=r}return c}();function f(){}e.NOOP=f;f.prototype.append=function t(e,r){return e};f.prototype.flush=function t(){}})(this);